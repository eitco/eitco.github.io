<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Universal Import Service 3.0.0-SNAPSHOT</title>
<style>
@import "https://eitco.github.io/eitco.css";


</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_universal_import_service_3_0_0_snapshot"><strong>Universal Import Service 3.0.0-SNAPSHOT</strong></a>
<ul class="sectlevel2">
<li><a href="#_configuration">Configuration</a></li>
</ul>
</li>
<li><a href="#_generic_csv_mapper"><strong>Generic CSV mapper</strong></a>
<ul class="sectlevel2">
<li><a href="#_attribute_mapping">Attribute mapping</a></li>
<li><a href="#_simple_mode">Simple mode</a></li>
<li><a href="#_counting_mode">Counting mode</a></li>
<li><a href="#_referencing_mode">Referencing mode</a></li>
<li><a href="#_content_preprocessing">Content preprocessing</a></li>
<li><a href="#_attribute_preprocessing">Attribute preprocessing</a></li>
<li><a href="#_conflict_resolution_strategies">Conflict resolution strategies</a></li>
</ul>
</li>
<li><a href="#_importing_from_csf_files"><strong>Importing from CSF files</strong></a>
<ul class="sectlevel2">
<li><a href="#_settings_from_csf_headers">Settings from CSF headers</a></li>
<li><a href="#_configuring_csf_imports">Configuring CSF imports</a></li>
</ul>
</li>
<li><a href="#_writing_a_custom_line_mapper"><strong>Writing a custom line mapper</strong></a></li>
<li><a href="#_generic_file_mapper"><strong>Generic file mapper</strong></a>
<ul class="sectlevel2">
<li><a href="#_property_collection">Property collection</a></li>
<li><a href="#_attribute_mapping_2">Attribute mapping</a></li>
<li><a href="#_example_configuration">Example configuration</a></li>
<li><a href="#_extensions">Extensions</a></li>
</ul>
</li>
<li><a href="#_writing_a_custom_file_mapper"><strong>Writing a custom file mapper</strong></a></li>
<li><a href="#_configuration_properties">Configuration Properties</a>
<ul class="sectlevel2">
<li><a href="#_generic-csv-mapper_settings">generic-csv-mapper.settings</a></li>
<li><a href="#_generic-file-mapper_settings">generic-file-mapper.settings</a></li>
<li><a href="#_universal-import-service">universal-import-service</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div style="page-break-after: always;"></div>
<div class="sect1">
<h2 id="_universal_import_service_3_0_0_snapshot"><strong>Universal Import Service 3.0.0-SNAPSHOT</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Universal Import Service is used to import data into arveo from third party systems. Currently, the service
supports reading data from CSV files and from the filesystem.</p>
</div>
<div class="paragraph">
<p>The service is based on Apache Camel and monitors configurable directories for files to import. It provides plugin interfaces
for <code>CsvLineMappers</code> and <code>FileMappers</code>. <code>CsvLineMappers</code> are used to create one or more arveo entities from one line in
a CSV file. <code>FileMappers</code> do the same for arbitrary files. A highly configurable default mapper implementation for both
use cases is provided, which should be sufficient for most import scenarios.</p>
</div>
<div class="sect2">
<h3 id="_configuration">Configuration</h3>
<div class="paragraph">
<p>The service offers some generic settings that apply to all mapping configurations. Because the service is based on
<a href="https://camel.apache.org">Apache Camel</a>, several configuration options for the Camel components apply.</p>
</div>
<div class="paragraph">
<p>The Camel routes used to import files use a URI-parameter to configure the start of the route. This makes it possible
to select and configure the Camel component for the start of the route by URI scheme.</p>
</div>
<div class="paragraph">
<p>A URI must be configured for each directory to import files from. The keys in the configuration maps define the IDs of
the Camel routes. In the following example, three CSV import routes and one file import route are configured.</p>
</div>
<div class="listingblock">
<div class="title">configuring the URIs for CSV imports</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">universal-import-service</span>:
  <span class="key">csv</span>:
    <span class="key">csv-import-1</span>:
      <span class="key">uri</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://${project.build.testOutputDirectory}/csv?antInclude=**/test-Demo.csv&amp;noop=false</span><span class="delimiter">&quot;</span></span>
    <span class="key">csv-import-2</span>:
      <span class="key">uri</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://${project.build.testOutputDirectory}/csv?antInclude=**/test-100.csv&amp;noop=false</span><span class="delimiter">&quot;</span></span>
    <span class="key">csv-import-3</span>:
      <span class="key">uri</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://${project.build.testOutputDirectory}/csv?antInclude=**/test-100_2.csv&amp;noop=false</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">configuring the URI for file imports</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">universal-import-service</span>:
  <span class="key">file</span>:
    <span class="key">file-import-1</span>:
      <span class="key">uri</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://${project.build.testOutputDirectory}/content?noop=true&amp;moveFailed=.error</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example, the file component of Apache Camel is activated by the <code>file:</code> scheme of the URI. The
<a href="https://camel.apache.org/components/next/file-component.html">Camel documentation</a> contains information about the available
parameters for the file endpoint as well as the other available endpoints.</p>
</div>
<div class="paragraph">
<p>The way CSV files are processed is controlled by the CSV data format of Apache Camel. It offers various configuration
properties, that are listed in the <a href="https://camel.apache.org/components/next/dataformats/csv-dataformat.html">Camel documentation</a>.
The properties can be used in the configuration file for the Universal Import Service as shown below:</p>
</div>
<div class="listingblock">
<div class="title">configing the CSV data format</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">camel</span>:
  <span class="key">dataformat</span>:
    <span class="key">csv</span>:
      <span class="key">delimiter</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">;</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example, the delimiter for the CSV columns is set to <code>;</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The configuration settings for the CSV data format apply to all CVS import routes.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_generic_csv_mapper"><strong>Generic CSV mapper</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The generic CSV mapper is the default implementation of the <code>CsvLineMapper</code> interface contained in the service.
The mapper maps each column in the CSV file to an attribute of an arveo entity. Content to import is read from a
configurable column, which can contain zero or more file names to import. The file names can either contain a fully
qualified path, or just the name of the file. In the later case, the directory containing the files with the actual
content can be configured (see below).</p>
</div>
<div class="paragraph">
<p>The mapper offers three different modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SIMPLE: This is the default. Each line in the CSV file is mapped to one arveo document, which might contain zero or more
content elements. The mapping of files to content elements is fixed and can either map file names to content element
names or positions in the list of files to content element names.</p>
</li>
<li>
<p>COUNTING: Each line is mapped to one or more arveo documents. Each document contains either one content element or no
content at all. A counter can be used as prefix or suffix for any imported attribute to distinguish the documents
created for one line.</p>
</li>
<li>
<p>REFERENCING: Each line is mapped as a simple record structure consisting of a container entity containing all attributes
and zero or more document components referenced by a foreign key, each containing one content element.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The generic CSV mapper supports individual configurations for each configured import route as shown in the following
example:</p>
</div>
<div class="listingblock">
<div class="title">configuring the generic mapper</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">universal-import-service</span>:
  <span class="key">csv</span>:
    <span class="key">csv-import-1</span>: <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="key">uri</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://...</span><span class="delimiter">&quot;</span></span>
  <span class="key">generic-csv-mapper</span>:
    <span class="key">settings</span>:
      <span class="key">csv-import-1</span>: <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="key">type-definition-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">demo_document</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The ID of the import route for the configured directory</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The ID of the configuration for the generic CSV mapper. Must match the ID of the import route.</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_attribute_mapping">Attribute mapping</h3>
<div class="paragraph">
<p>The mapping of CSV columns to arveo attributes works the same in each mode. An <em>attribute mapping</em> must be configured
for each CSV column that is supposed to be imported. Attribute mappings are configured in a map, the keys being the
names of the columns of the CSV file. An attribute mapping consists of the following parameters:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. attribute mapping parameters</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attribute-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the arveo attribute (in snake-case)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the attribute (<code>SHORT</code>, <code>INTEGER</code>, <code>LONG</code>, <code>DOUBLE</code>, <code>STRING</code>, <code>BOOLEAN</code>, <code>DATE_TIME</code>, <code>DATE</code> or <code>TIME</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the attribute is multivalued or not (the default is false).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delimiter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The delimiter of multivalued attributes. Ignored when <code>array</code> is set to false.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html">pattern</a> used to parse attributes of type <code>DATE</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html">pattern</a> used to parse attributes of type <code>TIME</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date-time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html">pattern</a> used to parse attributes of type <code>DATE_TIME</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">zone-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://docs.oracle.com/javase/8/docs/api/java/time/ZoneId.html">time zone ID</a> used when the value in the CSV column for <code>DATE_TIME</code> attributes does not contain time zone information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">local-date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local data for a date-time attribute used if the value does not contain a date. Must be in ISO-8601 format such as '2011-12-03'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">local-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local time for a date-time attribute used if the value does not contain a time. Must be in ISO-8601 format such as '10:15' or '10:15:30'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional prefix added to imported attributes of type <code>STRING</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">suffix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional suffix added to imported attributes of type <code>STRING</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default value used when the line does not contain a value for a configured attribute mapping. Must follow the same format rules as the other values in the column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number-format.patterm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Format <a href="https://docs.oracle.com/javase/8/docs/api/java/text/DecimalFormat.html">pattern</a> for numeric values.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number-format.grouping-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The grouping separator character.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number-format.decimal-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The decimal separator character.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique-identifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marks the attribute as a unique identifier or as part of a combined unique identifier that will be used to check if the entity already exists.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Attributes are parsed using the configures number format settings for numeric values, or using the supplied
patterns for date, time or date-time values. Booleans can either be Strings ('true', 'false') or integers (0,1).</p>
</div>
<div class="paragraph">
<p>The settings for numeric values allow configuring group- and decimal-separators as well as a (non-localized) pattern for numeric
values. The default pattern <code>#,##0.###</code> requires one or more digits in front of the decimal separator and up to three
digits behind the decimal separator. The default grouping separator is <code>,</code>. The default decimal separator is <code>.</code>. Note
that the separators in the pattern are not localized, e.g. they have to be the default separators for the english locale.</p>
</div>
<div class="paragraph">
<p>Empty values (null, an empty string or a string containing only whitespace) are mapped to null. A default value to return
instead can be configured in the attribute mapping. The default value is a string in the same format as expected in the
original value.</p>
</div>
<div class="paragraph">
<p>The default date-time-pattern used by the importer for date-time attributes (<code>[u-M-d]['T'][H:m:s][X]</code>) allows
parsing partial values for date-time attributes. The parts in square brackets (the date, the letter 'T', the time and
the zone) are optional. If no value for these parts is contained in the parsed value, it is replaced by the configured
default <code>local-date</code>, <code>local-time</code> or <code>zone-id</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The partial default values <code>local-date</code>, <code>local-time</code> and <code>zone-id</code> will not be used for empty values. Use the
<code>default-value</code> instead to configure a default for empty values.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Attribute mappings are configured for each mapper mode. For example, when the counting mode is used, the attribute
mappings would be configured in the setting <code>universal-import-service.generic-csv-mapper.counting.attributes</code>.</p>
</div>
<div class="paragraph">
<p>The example below shows a mapping configuration for the import of CSV columns called 'sysrowid', 'systimestamp' and
'ispdf'.</p>
</div>
<div class="listingblock">
<div class="title">attribute mapping</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">attributes</span>:
  <span class="key">sysrowid</span>:
    <span class="key">attribute-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">sys_row_id</span><span class="delimiter">&quot;</span></span>
    <span class="key">type</span>: <span class="string"><span class="content">STRING</span></span>
    <span class="key">unique-identifier</span>: <span class="string"><span class="content">true</span></span>
  <span class="key">systimestamp</span>:
    <span class="key">attribute-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">sys_time_stamp</span><span class="delimiter">&quot;</span></span>
    <span class="key">type</span>: <span class="string"><span class="content">DATE_TIME</span></span>
    <span class="key">date-time-pattern</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">u-M-d H:m:s</span><span class="delimiter">&quot;</span></span>
    <span class="key">zone-id</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">UTC</span><span class="delimiter">&quot;</span></span>
  <span class="key">ispdf</span>:
    <span class="key">attribute-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">pdf</span><span class="delimiter">&quot;</span></span>
    <span class="key">type</span>: <span class="string"><span class="content">BOOLEAN</span></span>
  <span class="key">archive</span>:
    <span class="key">attribute-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">archive</span><span class="delimiter">&quot;</span></span>
    <span class="key">type</span>: <span class="string"><span class="content">STRING</span></span>
    <span class="key">default-value</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">records</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Attributes using a default value do not have to be contained in the CSV file. This makes it possible to add new
attributes that were not contained in the original data.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_null_values">null values</h4>
<div class="paragraph">
<p>When an entity is updated, it might be necessary to actively set an existing attribute value in the archive to null.
This can be achieved by setting the value of the attribute in the imported data to the configured <code>attribute-null-value</code>.
The default attribute null value is <code>$null</code>.When this value is used as a <code>default-value</code> in an attribute mapping, attributes
not present in the imported data will be set to null.</p>
</div>
</div>
<div class="sect3">
<h4 id="_unique_identifier_checks">Unique identifier checks</h4>
<div class="paragraph">
<p>When an attribute mapping uses the <code>unique-identifier: true</code> setting, it will be used to check if the entity already
exists in the archive before the line is processed.When multiple attribute mappings are marked as unique identifiers,
all attribute values are compared to check for existence.There are some limitations to keep in mind when this feature
is used:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Each check requires an additional request that performs a query. For performance reasons, the existence checks should be
disabled for the initial import.</p>
</li>
<li>
<p>The referencing mode will only check for existing entities in the container type definition.</p>
</li>
<li>
<p>The counting mode still needs to preprocess the uploaded content to determine the number of entities to create before
the existence checks can be done.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_simple_mode">Simple mode</h3>
<div class="paragraph">
<p>The simple mode is the default operating mode of the generic CSV mapper. In this mode, a 1:1 mapping between file names
read from the CSV file and content element names must be configured. The mapping can either be from file name to content
element name or from the position of the file name in the list to a content element name.
Because the simple mode is the default, it does not habe to be explicitly enabled in the configuration.</p>
</div>
<div class="listingblock">
<div class="title">simple mode configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">generic-csv-mapper</span>:
  <span class="key">settings</span>:
    <span class="key">csv-import-1</span>: <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="key">type-definition-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">demo_document</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
      <span class="key">conflict-resolution-strategy</span>: <span class="string"><span class="content">UPDATE_ATTRIBUTES</span></span>
      <span class="key">simple</span>:
        <span class="key">content</span>:
          <span class="key">csv-field-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">filename</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
          <span class="key">content-path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${project.build.testOutputDirectory}/content</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="4"></i><b>(4)</b>
          <span class="key">position-mappings</span>:
            <span class="key">0</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">content</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name of the import configuration. Must match the name of the configured route (see <a href="#_configuration">configuration</a>])</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The name of the type definition that will contain the imported documents</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The name of the field in the CSV file containing the file names</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The path of the directory that contains the files. In this case, the CSV is expected to contain only the file names.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Mapping by position. The first file will be stored in the content element named "content".</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A complete configuration example can be found in the system-test module in the file <code>src/test/resource-templates/config/universal-import-service.yaml</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_counting_mode">Counting mode</h3>
<div class="paragraph">
<p>In the counting mode, CSV lines containing more than one filename are mapped to multiple independent document entities.
Each document entity will contain one content element. If a line in the CSV file does not contain any file names, one
document with no content elements will be created. A counter can be added to the suffix or prefix of any string attribute
by using the placeholder <code>$+{contentElementNumber}+</code>.</p>
</div>
<div class="listingblock">
<div class="title">counting mode configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">generic-csv-mapper</span>:
  <span class="key">settings</span>:
    <span class="key">csv-import-2</span>:
      <span class="key">type-definition-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">document</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="key">mode</span>: <span class="string"><span class="content">COUNTING </span></span><i class="conum" data-value="2"></i><b>(2)</b>
      <span class="key">counting</span>:
        <span class="key">conflict-resolution-strategy</span>: <span class="string"><span class="content">UPDATE_ATTRIBUTES</span></span>
        <span class="key">content</span>:
          <span class="key">csv-field-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">filename</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
          <span class="key">delimiter</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">,</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="4"></i><b>(4)</b>
          <span class="key">content-path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${project.build.testOutputDirectory}/content</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="5"></i><b>(5)</b>
        <span class="key">attributes</span>:
          <span class="key">xhdoc</span>:
            <span class="key">attribute-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">xhdoc</span><span class="delimiter">&quot;</span></span>
            <span class="key">type</span>: <span class="string"><span class="content">STRING</span></span>
            <span class="key">suffix</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">_${contentElementNumber}</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="6"></i><b>(6)</b>
            <span class="key">unique-identifier</span>: <span class="string"><span class="content">true</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name of the type definition that will contain the imported documents</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The counting mode must be enabled explicitly</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The name of the field in the CSV file containing the file names</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The delimiter used to separate file names</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The path of the directory that contains the files. In this case, the CSV is expected to contain only the file names.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Adds a suffix with the counter (starting at 1) of the file</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A complete configuration example can be found in the system-test module in the file <code>src/test/resource-templates/config/universal-import-service-counting.yaml</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_referencing_mode">Referencing mode</h3>
<div class="paragraph">
<p>In the referencing mode, a record container is created for each imported document. This record will contain all attributes,
but no content. For each imported file, a document is created that contains only the data of the imported file. The
documents are referenced by a foreign key containing the ID of the record container.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The imported documents do not contain any custom attributes, but arveo&#8217;s inheritance feature can be used to automatically
inherit attributes from the referenced record.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">referencing mode configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">generic-csv-mapper</span>:
  <span class="key">settings</span>:
    <span class="key">csv-import-3</span>:
      <span class="key">type-definition-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">component</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="key">conflict-resolution-strategy</span>: <span class="string"><span class="content">UPDATE_ATTRIBUTES</span></span>
      <span class="key">mode</span>: <span class="string"><span class="content">REFERENCING </span></span><i class="conum" data-value="2"></i><b>(2)</b>
      <span class="key">referencing</span>:
        <span class="key">container-type-definition-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">container</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="key">reference-field-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">container_id</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="key">content</span>:
          <span class="key">csv-field-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">filename</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="5"></i><b>(5)</b>
          <span class="key">delimiter</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">,</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="6"></i><b>(6)</b>
          <span class="key">content-path</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">${project.build.testOutputDirectory}/content</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name of the type definition that will contain the imported documents</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The referencing mode must be enabled explicitly</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The name of the type definition containing the record containers</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The name of the attribute in the documents containing the foreign key</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The name of the field in the CSV file containing the file names</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The delimiter used to separate file names</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The path of the directory that contains the files. In this case, the CSV is expected to contain only the file names.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A complete configuration example can be found in the system-test module in the file <code>src/test/resource-templates/config/universal-import-service-referencing.yaml</code>.</p>
</div>
<div class="sect3">
<h4 id="_configuring_the_foreign_key">Configuring the foreign key</h4>
<div class="paragraph">
<p>The foreign key links the document entities to a container entity. As shown above, the reference field name in the document
entities must be configured. The field in the container entity referenced by the foreign key is, by default, the system
field <code>id</code>. The value will be retrieved automatically by the batch processing API of the content repository service.
It is possible to change the name of the referenced field using the property <code>reference-target-field-name</code>.
It is also possible to disable the automatic retrieval of the foreign key value by configuring no value for the
<code>reference-field-name</code> property. The value must be provided by the attribute mappings in this case.</p>
</div>
</div>
<div class="sect3">
<h4 id="_document_attributes">Document attributes</h4>
<div class="paragraph">
<p>By default, the document does not have any attributes except the required system fields and the reference field. In some
cases, the document type definition might require additional custom fields. Those can be configured by providing
additional attribute mappings for the document entities as shown below:</p>
</div>
<div class="listingblock">
<div class="title">configuring document attribute mappings</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">generic-csv-mapper</span>:
  <span class="key">settings</span>:
    <span class="key">csv-import-3</span>:
      <span class="key">mode</span>: <span class="string"><span class="content">REFERENCING</span></span>
      <span class="key">referencing</span>:
        <span class="key">document-attributes</span>:
          <span class="key">docid</span>:
            <span class="key">attribute-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">doc_id</span><span class="delimiter">&quot;</span></span>
            <span class="key">type</span>: <span class="string"><span class="content">STRING</span></span>
          <span class="key">contentRep</span>:
            <span class="key">attribute-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">repository_id</span><span class="delimiter">&quot;</span></span>
            <span class="key">type</span>: <span class="string"><span class="content">STRING</span></span>
          <span class="key">componentName</span>:
            <span class="key">attribute-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">component_id</span><span class="delimiter">&quot;</span></span>
            <span class="key">type</span>: <span class="string"><span class="content">STRING</span></span>
            <span class="key">default-value</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">data_${documentNumber}</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The generic CSV mapper provides one placeholder <code>$+{documentNumber}+</code> that contains the document&#8217;s number (starting at 1)
and that can be used either in a prefix or suffix or in a default value.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_content_preprocessing">Content preprocessing</h3>
<div class="paragraph">
<p>The generic CSV mapper provides an additional extension mechanism that can be used to preprocess the binary content for
each individual line in the CSV file before it is handed over to the mapper. This way it is possible to perform tasks
like decryption, conversion or merging of content.</p>
</div>
<div class="paragraph">
<p>The extension mechanism works by registering a bean of type <code>de.eitco.uis.mappers.common.ContentPreprocessor</code> (for example, by
creating a custom Spring Boot starter). Each ContentPreprocessor must implement the <code>preprocess</code> method, which has
the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>fileNames</code>: A list of file names that was parsed from the current line in the CSV file (never null)</p>
</li>
<li>
<p><code>csvFilePath</code>: The directory that contains the CSV file (never null)</p>
</li>
<li>
<p><code>contentPath</code>: The configured path used to find the actual files (might be null)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The ContentPreprocessor returns a list of <code>PreprocessedContent</code> instances, which consist of an <code>InputStream</code>, the
file name that will be used in arveo and the position of the file in the original list of file names. How many <code>PreprocessedContent</code>
instances are contained in the returned list depends on the preprocessor. For example, an implementation might take
all files and merge them to a single PDF file. Other implementations might just wrap the returned streams for decryption.
Custom implementation can extend the class <code>de.eitco.uis.mappers.common.AbstractContentPreprocessor</code> which contains a utility
method to open new <code>FileInputStreams</code>.</p>
</div>
<div class="paragraph">
<p>It is possible to register several <code>ContentPreprocessor</code> beans. The processor used for a specific import route is
selected by calling the processor&#8217;s <code>usedForRoute</code> method with the ID of the route. The first processor found that returns
true in this method will be used.</p>
</div>
<div class="paragraph">
<p>The interfaces to implement as well as the other classes required to implement a <code>ContentPreprocessor</code> are contained
in the following artifact:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>de.eitco.uis<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>universal-import-mappers-common<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${import.service.version}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable custom extensions, the Jar containing the Spring Boot Starter (and any additional Jar, if required) must be
placed in the directory configured as loader path of the service using the <code>-Dloader.path</code> parameter.</p>
</div>
</div>
<div class="sect2">
<h3 id="_attribute_preprocessing">Attribute preprocessing</h3>
<div class="paragraph">
<p>Similar to the content preprocessing plugin mechanism, there is another extension mechanism that can be used to perform
custom preprocessing actions on the mapped attributes.</p>
</div>
<div class="paragraph">
<p>The extension mechanism works by registering a bean of type <code>de.eitco.uis.mappers.common.AttributesPreprocessor</code> (for example, by
creating a custom Spring Boot starter). Each AttributesPreprocessor must implement the <code>preprocessAttributes</code> method, which has
the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>attributes</code>: The attributes that were resolved by the configured mappings</p>
</li>
<li>
<p><code>line</code>: The original line in the CSV being processed</p>
</li>
<li>
<p><code>contentUploadMap</code>: A map containing the resolved content uploads (after being preprocessed)</p>
</li>
<li>
<p><code>csvFilePath</code>: The path of the current CSV file</p>
</li>
<li>
<p><code>typeDefinitionName</code>: The name of the type definition the attributes will be used for</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The AttributesPreprocessor must return a map containing all attributes that are supposed to be added to the created
entity. It can remove, add or edit any attribute already present in the map.</p>
</div>
<div class="paragraph">
<p>It is possible to register several <code>AttributesPreprocessor</code> beans. The processor used for a specific import route is
selected by calling the processor&#8217;s <code>usedForRoute</code> method with the ID of the route. The first processor found that returns
true in this method will be used.</p>
</div>
<div class="paragraph">
<p>The interfaces to implement as well as the other classes required to implement a <code>AttributesPreprocessor</code> are contained
in the following artifact:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>de.eitco.uis<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>universal-import-mappers-common<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${import.service.version}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable custom extensions, the Jar containing the Spring Boot Starter (and any additional Jar, if required) must be
placed in the directory configured as loader path of the service using the <code>-Dloader.path</code> parameter.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conflict_resolution_strategies">Conflict resolution strategies</h3>
<div class="paragraph">
<p>The Universal Import Service features several different strategies to resolve conflicts with already existing entities.</p>
</div>
<div class="paragraph">
<p>The strategy to use can be selected by configuring the following parameter.The default strategy is <code>SKIP</code>.</p>
</div>
<div class="listingblock">
<div class="title">conflict resolution strategy for the simple mapper mode</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">universal-import-service</span>:
  <span class="key">generic-csv-mapper</span>:
    <span class="key">settings</span>:
      <span class="key">csv-import-1</span>:
        <span class="key">simple</span>:
          <span class="key">conflict-resolution-strategy</span>: <span class="string"><span class="content">UPDATE_ATTRIBUTES</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">conflict resolution strategy for the counting mapper mode</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">universal-import-service</span>:
  <span class="key">generic-csv-mapper</span>:
    <span class="key">settings</span>:
      <span class="key">csv-import-2</span>:
        <span class="key">mode</span>: <span class="string"><span class="content">COUNTING</span></span>
        <span class="key">counting</span>:
          <span class="key">conflict-resolution-strategy</span>: <span class="string"><span class="content">UPDATE_ATTRIBUTES</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">conflict resolution strategy for the referencing mapper mode</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">universal-import-service</span>:
  <span class="key">generic-csv-mapper</span>:
    <span class="key">settings</span>:
      <span class="key">csv-import-3</span>:
        <span class="key">mode</span>: <span class="string"><span class="content">REFERENCING</span></span>
        <span class="key">referencing</span>:
          <span class="key">conflict-resolution-strategy</span>: <span class="string"><span class="content">UPDATE_ATTRIBUTES</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following strategies are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SKIP</code>: The default strategy. Existing entities will be skipped.</p>
</li>
<li>
<p><code>UPDATE</code>: Existing entities will be updated.</p>
</li>
<li>
<p><code>UPDATE_ATTRIBUTES</code>: Attributes of existing entities will be updated. The content of documents will be ignored.</p>
</li>
<li>
<p><code>OVERWRITE</code>: Existing entities will be overwritten.</p>
</li>
<li>
<p><code>OVERWRITE_ATTRIBUTES</code>: Attributes of existing entities will be overwritten. The content of documents will be ignored.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Overwriting existing entities must be enabled in the type definition in use.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Except for the default <code>SKIP</code> strategy, all other strategies require at least one <code>unique-identifier</code> attribute. The
unique identifier attributes will be used to create a selector passed on to the Content Repository Service.
The Content Repository Service will use this selector to perform an update on the existing entity.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_importing_from_csf_files"><strong>Importing from CSF files</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Universal Import Service can be used to import data from Saperion CSF files. CSF files are basically CSV files with
a proprietary header containing configuration for the Saperion importers. The Universal Import Service can use some of
the settings read from the header. The reading of the actual data from the CSF file is done using the same mechanism as is
used for generic CSV files. So the same configuration options, especially for attribute mappings, can be used for CSF
files, too.</p>
</div>
<div class="sect2">
<h3 id="_settings_from_csf_headers">Settings from CSF headers</h3>
<div class="paragraph">
<p>The following information is read from the CSF headers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>separator</strong>: The separator used in the body of the CSF file.</p>
</li>
<li>
<p><strong>date pattern</strong>: The format of date values in the body of the CSF file</p>
</li>
<li>
<p><strong>time pattern</strong>: The format of time values in the body of the CSF file</p>
</li>
<li>
<p><strong>date-time pattern</strong>: The format of timestamps in the body of the CSF file</p>
</li>
<li>
<p><strong>lagacy-import-mode</strong>: This controls the behavior of the old import mechanism in the Saperion Rich Client or Core Server.</p>
</li>
<li>
<p><strong>duplicate handling</strong>: This controls how the Saperion Universal Importer handles duplicate documents.</p>
</li>
<li>
<p><strong>document handling</strong>: This controls how the Saperion Universal Importer treats actual binary content of duplicate documents.</p>
</li>
<li>
<p><strong>property handling</strong>: This controls how the Saperion Universal Importer treats attributes of duplicate documents.</p>
</li>
<li>
<p><strong>DDC name</strong>: The name of the Saperion DDC to import data into.</p>
</li>
<li>
<p><strong>key field names</strong>: Names of fields that can be used to identify duplicate documents.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Except for the separator, all of these fields in the header are optional.</p>
</div>
<div class="paragraph">
<p>The Universal Import Service uses the separator and the patterns for date, time and date-time values (if present) to
read the actual data from the CSF file. The key field names are used to identify potential conflicts with already
existing entities. The DDC name can be used in the configuration (see <a href="#_configuring_csf_imports">below</a>) to determine the name of the type definition
to import into.</p>
</div>
<div class="paragraph">
<p>The Universal Import Service maps the settings for the legacy import mode and the duplicate, document and property
handling to the <a href="#<em>conflict_resolution_strategies">conflict resolution strategies</a> of the
generic CSV mapper. Due to the differences in the data model between Saperion and _arveo</em>, not all of these settings
are supported.</p>
</div>
<div class="sect3">
<h4 id="_legacy_import_mode">Legacy import mode</h4>
<div class="paragraph">
<p>The legacy import mode setting can be mapped to the conflict resolution strategies. Both modes are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>U</strong> (update-only): Only entities that are already present in the archive will be updated. No new entities will be created.</p>
</li>
<li>
<p><strong>A</strong> (create-or-update): Existing entities will be updated, new entities will be created.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This will work only when the key field names are not empty.</p>
</div>
</div>
<div class="sect3">
<h4 id="_duplicate_handling">Duplicate handling</h4>
<div class="paragraph">
<p>Because <em>arveo</em> enforces uniqueness of entities, only the <code>REVISE</code> and <code>REVISEONLY</code> modes are supported.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>REVISE</code> (create-or-update): Existing entities will be updated, new entities will be created.</p>
</li>
<li>
<p><code>REVISEONLY</code> (update-only): Only entities that are already present in the archive will be updated. No new entities will be created.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_document_handling">Document handling</h4>
<div class="paragraph">
<p>In difference to Saperion, <em>arveo</em> does not support arbitrary content elements for one document entity. Some of the
behavior of the Saperion Universal Importer can be reproduced using the different importing modes of the
<a href="#">generic CSV mapper</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SIMPLE</code>: In the simple mode, the number of possible content elements is fixed. The importer will update existing content
elements, but new ones cannot be appended.</p>
</li>
<li>
<p><code>COUNTING</code>: In this mode, the importer will create seprate documents for each content element. This makes it possible
to update existing ones and to create new entities for additional content elements.</p>
</li>
<li>
<p><code>REFERENCING</code>: In this mode, content elements are stored as separate document entities which are linkes to a common
container entity using foreign keys. This mode will append new content elements and replace existing ones when they
can be identified by a unique key.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>REPLACEALL</code> mode of the Saperion Universal Importer is not supported.</p>
</div>
</div>
<div class="sect3">
<h4 id="_property_handling">Property handling</h4>
<div class="paragraph">
<p>The setting for the property handling mode is ignored.By default, the Universal Import Service will behave as if the
<code>UPDATE</code> setting is active.However, it is possible to reproduce the <code>OVERWRITE</code> behavior by using the
<a href="#_null_values">attriute-null-value</a> as a default value for attributes not present in the body
of the CSF file.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_csf_imports">Configuring CSF imports</h3>
<div class="paragraph">
<p>CSF imports are configured by defining the file system resource to monitor for CSF files as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">universal-import-service</span>:
  <span class="key">csf</span>:
    <span class="key">csf-import-1</span>:
      <span class="key">uri</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://${project.build.testOutputDirectory}/csf?antInclude=**/csftest1.csf&amp;noop=false</span><span class="delimiter">&quot;</span></span>
    <span class="key">csf-import-2</span>:
      <span class="key">uri</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://${project.build.testOutputDirectory}/csf?antInclude=**/csftest4.csf&amp;noop=false</span><span class="delimiter">&quot;</span></span>
    <span class="key">csf-import-3</span>:
      <span class="key">uri</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://${project.build.testOutputDirectory}/csf?antInclude=**/csftest3.csf&amp;noop=false</span><span class="delimiter">&quot;</span></span>
  <span class="key">type-name-mappings</span>: <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="key">AMV_TBL</span>: <span class="string"><span class="content">incident</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This setting can be used to configure a mapping from DDC names read from the CSF header to type definition names</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_writing_a_custom_line_mapper"><strong>Writing a custom line mapper</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Custom line mappers have to implement the interface <code>CsvLineMapper</code>. Mappers can use the typed or the generic API of arveo.
A mapper that uses the generic API has to return true in the <code>isGeneric</code> method implementation and has to implement the
<code>mapLineGeneric</code> method. Typed mappers have to return false in the <code>isGeneric</code> method and have to implement the <code>mapLine</code>
method.</p>
</div>
<div class="paragraph">
<p>The custom mapper implementation has to be registered as a Spring bean in a custom Spring Boot starter. To replace the
provided default mapper, the custom auto starter either has to run before the auto configuration class <code>de.eitco.uis.mappers.csv.GenericCsvMapperAutoConfiguration</code>
or the default mapper bean registrations have to be disabled by setting the property <code>universal-import-service.generic-csv-mapper.enabled</code>
to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>Line mappers return a list of batch operations. The arveo entities created for one line can be created using the respective
batch operation(s). The operations will be executed in the order in which they are contained in the list.</p>
</div>
<div class="paragraph">
<p>The custom mapper can be activated by adding the jar of the custom starter to the service&#8217;s libs directory configured
by the parameter <code>-Dloader.path</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_generic_file_mapper"><strong>Generic file mapper</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The generic file mapper is the default implementation of the <code>FileMapper</code> interface contained in the service. It can
import files from a configurable directory into arveo. Properties of the files, for example parts of the path of file
name, can be extracted as attributes of the arveo entities.</p>
</div>
<div class="paragraph">
<p>The mapper operates in two phases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Phase 1: Collect properties of the file to import. These can be parts of the path, the length or type of the file.</p>
</li>
<li>
<p>Phase 2: Map collected properties to arveo attributes.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_property_collection">Property collection</h3>
<div class="paragraph">
<p>Which properties to collect is configurable. Properties can be extracted from the path and file name by position or by
using a regular expression. The path is split using the system&#8217;s path separator. The file name can be split using a
configurable separator. The value of each property is a string that can be mapped to an attribute using the attribute
mappings described below.</p>
</div>
<div class="sect3">
<h4 id="_positional_properties">Positional properties</h4>
<div class="paragraph">
<p>Positional properties are collected from the path or file name, after it is split into an array of strings either by using
the path separator or the configured file name separator character. The position can be given as a positive or negative
integer. A positive integer (starting at 1) defines the position from left to right. A negative integer (starting at -1)
defines the position from right to left. For example, in the path <code>/path/to/my/file.txt</code>, the position <code>1</code> would match
<code>path</code> and the position <code>-2</code> would match <code>my</code>. Likewise, when the file name is used to collect a property and the file
name separator is configured as <code>_</code>, the position <code>2</code> in the file name <code>invoice_20250982.pdf</code> would match <code>20250982</code>
(the extension is stripped from the file name by default).</p>
</div>
</div>
<div class="sect3">
<h4 id="_regular_expression_properties">Regular expression properties</h4>
<div class="paragraph">
<p>Properties can be extracted from the path or file name using a regular expression. The expression can use capturing
groups. The number of the group that contains the property can be configured. For example, the regular expression
<code>[-,_]([A-Z]{2})$</code> could be used to parse the language <code>DE</code> as two upper-case characters at the end of the file name
<code>EITCO_arveo-secom_Produktportfolio_DE.pdf</code>. The extension is removed from the filename by default before the expression
is matched against the file name.</p>
</div>
</div>
<div class="sect3">
<h4 id="_property_mapping">Property mapping</h4>
<div class="paragraph">
<p>Properties to collect are configured using a map, where the keys are the names of the properties. These names can then
be used in the attribute mappings. Each map entry can contain the following settings. Note that only one way to collect
a property can be used for each individual property.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. property mapping options</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">position-in-path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Position in the path split by path separator char. Positive or negative integer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">position-in-file-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Position in the file name split by file name separator char. Positive or negative integer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path-regex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regular expression matched on the path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">file-name-regex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regular expression matched on the file name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">remove-extension</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to remove the extension from the path or file name. Default is true.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Each regular expression has two settings:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. regular expression settings</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html">regular expression</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the number of the group containing the value (default is 0 for entire expression).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_predefined_properties">Predefined properties</h4>
<div class="paragraph">
<p>The mapper provides some predefined properties that can be used in attribute mappings without additional configuration
in the property mappings.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. predefined properties</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">_path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Absolute path of the file (string)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File name (string including extension)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">_parent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path of the file&#8217;s parent directory (string)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">_length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Length of the file (long)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">_extension</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension of the file name only (string)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">_last_modified</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Last modified timestamp of the file (in IS0-8601 format)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_attribute_mapping_2">Attribute mapping</h3>
<div class="paragraph">
<p>The collected properties (and the predefined properties) are mapped to arveo attributes in the attribute mappings.
The key of each attribute mapping must be a collected or predefined property name. Each attribute mapping can use
the following parameters:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. attribute mapping parameters</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attribute-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the arveo attribute (in snake-case)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the attribute (<code>SHORT</code>, <code>INTEGER</code>, <code>LONG</code>, <code>DOUBLE</code>, <code>STRING</code>, <code>BOOLEAN</code>, <code>DATE_TIME</code>, <code>DATE</code> or <code>TIME</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the attribute is multivalued or not (the default is false).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delimiter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The delimiter of multivalued attributes. Ignored when <code>array</code> is set to false.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html">pattern</a> used to parse attributes of type <code>DATE</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html">pattern</a> used to parse attributes of type <code>TIME</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date-time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html">pattern</a> used to parse attributes of type <code>DATE_TIME</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">zone-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <a href="https://docs.oracle.com/javase/8/docs/api/java/time/ZoneId.html">time zone ID</a> used when the value in the CSV column for <code>DATE_TIME</code> attributes does not contain time zone information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">local-date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local data for a date-time attribute used if the value does not contain a date. Must be in ISO-8601 format such as '2011-12-03'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">local-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local time for a date-time attribute used if the value does not contain a time. Must be in ISO-8601 format such as '10:15' or '10:15:30'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional prefix added to imported attributes of type <code>STRING</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">suffix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional suffix added to imported attributes of type <code>STRING</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default value used when the line does not contain a value for a configured attribute mapping. Must follow the same format rules as the other values in the column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number-format.patterm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Format <a href="https://docs.oracle.com/javase/8/docs/api/java/text/DecimalFormat.html">pattern</a> for numeric values.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number-format.grouping-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The grouping separator character.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number-format.decimal-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The decimal separator character.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">unique-identifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Marks the attribute as a unique identifier or as part of a combined unique identifier that will be used to check if the entity already exists.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Attributes are parsed using the configures number format settings for numeric values, or using the supplied
patterns for date, time or date-time values. Booleans can either be Strings ('true', 'false') or integers (0,1).</p>
</div>
<div class="paragraph">
<p>The settings for numeric values allow configuring group- and decimal-separators as well as a (non-localized) pattern for numeric
values. The default pattern <code>#,##0.###</code> requires one or more digits in front of the decimal separator and up to three
digits behind the decimal separator. The default grouping separator is <code>,</code>. The default decimal separator is <code>.</code>. Note
that the separators in the pattern are not localized, e.g. they have to be the default separators for the english locale.</p>
</div>
<div class="paragraph">
<p>Empty values (null, an empty string or a string containing only whitespace) are mapped to null. A default value to return
instead can be configured in the attribute mapping. The default value is a string in the same format as expected in the
original value.</p>
</div>
<div class="paragraph">
<p>The default date-time-pattern used by the importer for date-time attributes (<code>[u-M-d]['T'][H:m:s][X]</code>) allows
parsing partial values for date-time attributes. The parts in square brackets (the date, the letter 'T', the time and
the zone) are optional. If no value for these parts is contained in the parsed value, it is replaced by the configured
default <code>local-date</code>, <code>local-time</code> or <code>zone-id</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The partial default values <code>local-date</code>, <code>local-time</code> and <code>zone-id</code> will not be used for empty values. Use the
<code>default-value</code> instead to configure a default for empty values.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_example_configuration">Example configuration</h3>
<div class="paragraph">
<p>The generic file mapper supports individual configurations for each configured import route as shown in the following
example:</p>
</div>
<div class="listingblock">
<div class="title">configuring the generic mapper</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">universal-import-service</span>:
  <span class="key">file</span>:
    <span class="key">file-import-1</span>: <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="key">uri</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">file://...</span><span class="delimiter">&quot;</span></span>
  <span class="key">generic-file-mapper</span>:
    <span class="key">settings</span>:
      <span class="key">file-import-1</span>: <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="key">type-definition-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">files</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The ID of the import route for the configured directory</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The ID of the configuration for the generic file mapper. Must match the ID of the import route.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example shows how to configure the generic file mapper. The example collects three properties and maps
these and one of the predefined properties to attributes.</p>
</div>
<div class="listingblock">
<div class="title">example configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">generic-file-mapper</span>:
  <span class="key">settings</span>:
    <span class="key">file-import-1</span>: <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="key">conflict-resolution-strategy</span>: <span class="string"><span class="content">UPDATE_ATTRIBUTES</span></span>
      <span class="key">type-definition-name</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">files</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
      <span class="key">properties</span>: <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="key">parent-name</span>:
          <span class="key">position-in-path</span>: <span class="string"><span class="content">-2</span></span>
        <span class="key">drive-name</span>:
          <span class="key">position-in-path</span>: <span class="string"><span class="content">1</span></span>
        <span class="key">language</span>:
          <span class="key">file-name-regex</span>:
            <span class="key">expression</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">[-,_]([A-Z]{2})$</span><span class="delimiter">&quot;</span></span>
            <span class="key">group</span>: <span class="string"><span class="content">1</span></span>
      <span class="key">attributes</span>: <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="key">_name</span>:
          <span class="key">attribute-name</span>: <span class="string"><span class="content">file_name</span></span>
          <span class="key">type</span>: <span class="string"><span class="content">STRING</span></span>
          <span class="key">unique-identifier</span>: <span class="string"><span class="content">true</span></span>
        <span class="key">parent-name</span>:
          <span class="key">attribute-name</span>: <span class="string"><span class="content">parent_name</span></span>
          <span class="key">type</span>: <span class="string"><span class="content">STRING</span></span>
        <span class="key">language</span>:
          <span class="key">attribute-name</span>: <span class="string"><span class="content">language</span></span>
          <span class="key">type</span>: <span class="string"><span class="content">STRING</span></span>
        <span class="key">drive-name</span>:
          <span class="key">attribute-name</span>: <span class="string"><span class="content">drive_name</span></span>
          <span class="key">type</span>: <span class="string"><span class="content">STRING</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Name of the configuration. Must match the name of the configured import route.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Name of the type definition to import into</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Map of collected properties</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Mapping from properties to attributes</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_extensions">Extensions</h3>
<div class="paragraph">
<p>The generic file importer provides an extension mechanism that allows preprocessing of imported files, for example to
perform decryption. To use this extension mechanism, a bean of type <code>de.eitco.uis.mappers.common.FilePreprocessor</code> must
be registered with a custom Spring Boot Starter. <code>FilePreprocessors</code> can influence the way the actual content of the
file is read, as well as properties like file length, name and path. This mechanism can also be used to provide
attributes that will be added to the arveo entity created for the file. This allows to implement an import that reads
files from a directory that do not contain the actual content to import, but a link to another file containing the
actual content and a collection of attributes to import.</p>
</div>
<div class="paragraph">
<p>A second extension mechanism allows to resolve attributes from arbitrary sources for an imported file. For example,
the extension could read a YAML file containing additional attributes. To use this extension mechanism, a bean of type
<code>de.eitco.uis.mappers.common.AttributesProvider</code> must be registered. The attributes returned by an <code>AttributesProvider</code>
are added after the regular attribute mapping was performed. So it is possible to overwrite already resolved attributes
using an <code>AttributesProvider</code>.</p>
</div>
<div class="paragraph">
<p>It is possible to register several <code>FilePreprocessor</code> and <code>AttributesProvider</code> beans. The bean used for a specific
import route is selected by calling the bean&#8217;s <code>usedForRoute</code> method with the ID of the route. The first bean found that
returns true in this method will be used.</p>
</div>
<div class="paragraph">
<p>The required classes for the extensions are contained in the following artifact:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>de.eitco.uis<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>universal-import-mappers-common<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${import.service.version}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable custom extensions, the Jar containing the Spring Boot Starter (and any additional Jar, if required) must be
placed in the directory configured as loader path of the service using the <code>-Dloader.path</code> parameter.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_writing_a_custom_file_mapper"><strong>Writing a custom file mapper</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Custom file mappers have to implement the interface <code>FileMapper</code>. Mappers can use the typed or the generic API of arveo.
A mapper that uses the generic API has to return true in the <code>isGeneric</code> method implementation and has to implement the
<code>mapFileGeneric</code> method. Typed mappers have to return false in the <code>isGeneric</code> method and have to implement the <code>mapFile</code>
method.</p>
</div>
<div class="paragraph">
<p>The custom mapper implementation has to be registered as a Spring bean in a custom Spring Boot starter. To replace the
provided default mapper, the custom auto starter either has to run before the auto configuration class <code>de.eitco.uis.mappers.file.GenericFileMapperAutoConfiguration</code>
or the default mapper bean registration has to be disabled by setting the property <code>universal-import-service.generic-file-mapper.enabled</code>
to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>File mappers return a list of batch operations. The arveo entities created for one line can be created using the respective
batch operation(s). The operations will be executed in the order in which they are contained in the list.</p>
</div>
<div class="paragraph">
<p>The custom mapper can be activated by adding the jar of the custom starter to the service&#8217;s libs directory configured
by the parameter <code>-Dloader.path</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_properties">Configuration Properties</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_generic-csv-mapper_settings">generic-csv-mapper.settings</h3>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attribute-null-value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The string representing a null value of an attribute. An attribute with this value will be set to null when an entity is updated during an import.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$null</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute mappings.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the attribute is multivalued.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.attribute-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute in arveo.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.date-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pattern used to parse date values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.date-time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pattern used to parse date-time values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.default-value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional default value.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.delimiter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The delimiter of multivalued attributes.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.local-date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local data for a date-time attribute used if the value does not contain a date. Must be in ISO-8601 format such as '2011-12-03'.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.local-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local time for a date-time attribute used if the value does not contain a time. Must be in ISO-8601 format such as '10:15' or '10:15:30'</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.number-format.decimal-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">char</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The decimal separator used to parse numbers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.number-format.grouping-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">char</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The grouping separator used to parse numbers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>,</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.number-format.pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-localized pattern string for the number format. See {@link java.text.DecimalFormat}.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#,##0.###</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional prefix for STRING attributes.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.suffix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional suffix for STRING attributes.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pattern used to parse time values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AttributeType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the attribute.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.unique-identifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, the value of this attribute will be used to check if an entity with the same value already exists. If so,  the current entity will be skipped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.zone-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The zone ID used for date-time attribute if the value does not contain zone information.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflict-resolution-strategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConflictResolutionStrategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This determines how conflicts, such as existing entities with the same identifier, are handled.  &lt;ul&gt;  &lt;li&gt;SKIP: The entity will be skipped without making changes.&lt;/li&gt;  &lt;li&gt;UPDATE: The entity will be updated with the new data.&lt;/li&gt;  &lt;li&gt;UPDATE_ATTRIBUTES: Only attributes of the entity will be updated, ignoring its content.&lt;/li&gt;  &lt;li&gt;OVERWRITE: The current version of the entity will be entirely overwritten.&lt;/li&gt;  &lt;li&gt;OVERWRITE_ATTRIBUTES: Only attributes of the entity will be overwritten, ignoring its content.&lt;/li&gt;  &lt;/ul&gt;  The default strategy is set to SKIP.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skip</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">counting.content.content-element-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the content element to use.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default pattern for date values. Can be overridden by attribute specific setting.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>u-M-d</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date-time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default pattern for date-time values. Can be overridden by attribute specific setting.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[u-M-d]['T'][H:m:s][X]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entity-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EntityType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of entity created by the mapper (DOCUMENT or CONTAINER).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>document</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">local-date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local data for a date-time attribute if the value does not contain a date. Must be in ISO-8601 format such as '2011-12-03'.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">local-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local time for a date-time attribute if the value does not contain a time. Must be in ISO-8601 format such as '10:15' or '10:15:30'</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MapperMode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The mode used by the mapper.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>simple</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number-format.decimal-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Character</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The decimal separator used to parse numbers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number-format.grouping-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Character</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The grouping separator used to parse numbers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>,</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number-format.pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-localized pattern string for the number format. See java.text.DecimalFormat.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#,##0.###</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.container-type-definition-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the type definition that will contain the record containers.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.content.content-element-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the content element to use.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute mappings for the document entities. Can be empty.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the attribute is multivalued.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.attribute-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute in arveo.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.date-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pattern used to parse date values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.date-time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pattern used to parse date-time values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.default-value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional default value.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.delimiter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The delimiter of multivalued attributes.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.local-date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local data for a date-time attribute used if the value does not contain a date. Must be in ISO-8601 format such as '2011-12-03'.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.local-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local time for a date-time attribute used if the value does not contain a time. Must be in ISO-8601 format such as '10:15' or '10:15:30'</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.number-format.decimal-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">char</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The decimal separator used to parse numbers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.number-format.grouping-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">char</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The grouping separator used to parse numbers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>,</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.number-format.pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-localized pattern string for the number format. See {@link java.text.DecimalFormat}.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#,##0.###</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional prefix for STRING attributes.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.suffix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional suffix for STRING attributes.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pattern used to parse time values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AttributeType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the attribute.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.unique-identifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, the value of this attribute will be used to check if an entity with the same value already exists. If so,  the current entity will be skipped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.document-attributes.&lt;key&gt;.zone-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The zone ID used for date-time attribute if the value does not contain zone information.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.reference-field-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute in the document type definition containing the foreign key to the record containers. If  not set, no reference will be created automatically.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">referencing.reference-target-field-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute in the container type definition referenced by the foreign key. If not set, the ID  system field will be used.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">simple.content.file-name-mappings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mappings from file names to content element names.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">simple.content.position-mappings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mappings from the position of the file name in the list (starting at 0) to content element names.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default pattern for time values. Can be overridden by attribute specific setting.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>H:m:s</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type-definition-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the type definition the entities are imported into.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">zone-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default zone ID used when date-time pattern does not contain zone information. Can be overridden by attribute specific setting.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_generic-file-mapper_settings">generic-file-mapper.settings</h3>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute mappings.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the attribute is multivalued.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.attribute-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the attribute in arveo.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.date-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pattern used to parse date values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.date-time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pattern used to parse date-time values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.default-value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional default value.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.delimiter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The delimiter of multivalued attributes.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.local-date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local data for a date-time attribute used if the value does not contain a date. Must be in ISO-8601 format such as '2011-12-03'.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.local-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local time for a date-time attribute used if the value does not contain a time. Must be in ISO-8601 format such as '10:15' or '10:15:30'</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.number-format.decimal-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">char</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The decimal separator used to parse numbers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.number-format.grouping-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">char</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The grouping separator used to parse numbers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>,</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.number-format.pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-localized pattern string for the number format. See {@link java.text.DecimalFormat}.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#,##0.###</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional prefix for STRING attributes.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.suffix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional suffix for STRING attributes.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pattern used to parse time values.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AttributeType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the attribute.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.unique-identifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, the value of this attribute will be used to check if an entity with the same value already exists. If so,  the current entity will be skipped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes.&lt;key&gt;.zone-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The zone ID used for date-time attribute if the value does not contain zone information.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflict-resolution-strategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConflictResolutionStrategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This determines how conflicts, such as existing entities with the same identifier, are handled.  &lt;ul&gt;  &lt;li&gt;SKIP: The entity will be skipped without making changes.&lt;/li&gt;  &lt;li&gt;UPDATE: The entity will be updated with the new data.&lt;/li&gt;  &lt;li&gt;UPDATE_ATTRIBUTES: Only attributes of the entity will be updated, ignoring its content.&lt;/li&gt;  &lt;li&gt;OVERWRITE: The current version of the entity will be entirely overwritten.&lt;/li&gt;  &lt;li&gt;OVERWRITE_ATTRIBUTES: Only attributes of the entity will be overwritten, ignoring its content.&lt;/li&gt;  &lt;/ul&gt;  The default strategy is set to SKIP.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skip</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">content-element-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the content element in the type definition that will contain the file&#8217;s data.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default pattern for date values. Can be overridden by attribute specific setting.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>u-M-d</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date-time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default pattern for date-time values. Can be overridden by attribute specific setting.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[u-M-d]['T'][H:m:s][X]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entity-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EntityType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of entity created by the mapper (DOCUMENT or CONTAINER).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>document</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">file-name-property-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional separator used to split the filename in parts which can then be used to extract properties. Note  that this is a regular expression!</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">local-date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local data for a date-time attribute if the value does not contain a date. Must be in ISO-8601 format such as '2011-12-03'.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">local-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The local time for a date-time attribute if the value does not contain a time. Must be in ISO-8601 format such as '10:15' or '10:15:30'</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">properties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mappings for properties that can be extracted from the path and file name. Properties are then used as sources  for the attribute mappings.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">time-pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default pattern for time values. Can be overridden by attribute specific setting.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>H:m:s</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type-definition-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the type definition the entities are imported into.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">zone-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default zone ID used when date-time pattern does not contain zone information. Can be overridden by attribute specific setting.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_universal-import-service">universal-import-service</h3>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">csf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Settings for the CSF imports.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">csf.thread-pool-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The thread pool size used to process the CSF files.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">csf.uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The URI used to import CSF files.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">csv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Settings for the CSV imports.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">csv.thread-pool-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The thread pool size used to process the CSV files.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">csv.uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The URI used to import CSV files.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Settings for the file importer.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">file.thread-pool-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The thread pool size used to process the files.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">file.uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The URI used to import files.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">generic-csv-mapper.settings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Settings for the generic CSV mapper for each import.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">generic-file-mapper.settings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Settings for the generic file mapper for each import.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type-name-mappings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mappings from source type names to type definition names. Used for DDC names found in CSF headers.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-06-24 22:21:17 UTC
</div>
</div>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</body>
</html>